# update:job
#
# Edit standard job source files and sync to installed locations
#
# Generated by DeepWork - do not edit manually

description = "Edit standard job source files and sync to installed locations"

prompt = """
# update:job

**Standalone command** in the **update** job - can be run anytime

**Summary**: Update standard jobs in src/ and sync to installed locations

## Job Overview

A workflow for maintaining standard jobs bundled with DeepWork. Standard jobs
(like `deepwork_jobs` and `deepwork_policy`) are source-controlled in
`src/deepwork/standard_jobs/` and must be edited there—never in `.deepwork/jobs/`
or `.claude/commands/` directly.

This job guides you through:
1. Identifying which standard job(s) to update from conversation context
2. Making changes in the correct source location (`src/deepwork/standard_jobs/[job_name]/`)
3. Running `deepwork install` to propagate changes to `.deepwork/` and command directories
4. Verifying the sync completed successfully

Use this job whenever you need to modify job.yml files, step instructions, or hooks
for any standard job in the DeepWork repository.



## Instructions

# Update Standard Job

## Objective

Edit standard job source files in `src/deepwork/standard_jobs/` and sync changes to installed locations (`.deepwork/jobs/` and command directories).

## Task

When working in the DeepWork repository and you need to modify a standard job, this step ensures changes are made in the correct location and properly propagated.

### Important: Source of Truth

Standard jobs exist in THREE locations, but only ONE is the source of truth:

| Location | Purpose | Editable? |
|----------|---------|-----------|
| `src/deepwork/standard_jobs/[job]/` | **Source of truth** | **YES** |
| `.deepwork/jobs/[job]/` | Installed copy | NO - overwritten by install |
| `.claude/commands/[job].[step].md` | Generated commands | NO - regenerated by sync |

**NEVER edit files in `.deepwork/jobs/` or `.claude/commands/` for standard jobs!**

### Process

#### 1. Identify the Standard Job to Update

From the conversation context, determine:
- Which standard job needs updating (e.g., `deepwork_jobs`, `deepwork_policy`)
- What specific changes are needed (job.yml, step instructions, hooks, etc.)

Current standard jobs:
- `deepwork_jobs` - Core job management (define, implement, learn)
- `deepwork_policy` - Policy enforcement system

To check what standard jobs exist:
```bash
ls src/deepwork/standard_jobs/
```

#### 2. Make Changes in Source Location

Navigate to the source directory and make your changes:

```
src/deepwork/standard_jobs/[job_name]/
├── job.yml              # Job definition
├── steps/               # Step instruction files
│   └── [step].md
├── hooks/               # Hook scripts (if any)
└── templates/           # Templates (if any)
```

**Examples of common edits:**
- Modify `job.yml` to add/change steps, update stop_hooks, or adjust metadata
- Edit `steps/[step].md` to improve instructions
- Add new hook scripts in `hooks/`

#### 3. Run DeepWork Install

After making changes, run install to propagate them:

```bash
deepwork install --platform claude
```

This copies files from `src/deepwork/standard_jobs/` to `.deepwork/jobs/` and regenerates command files.

If you also need Gemini support:
```bash
deepwork install --platform gemini
```

#### 4. Verify the Sync

Check that changes propagated correctly:

**Verify job.yml:**
```bash
diff src/deepwork/standard_jobs/[job_name]/job.yml .deepwork/jobs/[job_name]/job.yml
```

**Verify step files:**
```bash
diff -r src/deepwork/standard_jobs/[job_name]/steps/ .deepwork/jobs/[job_name]/steps/
```

**Check command files were regenerated:**
```bash
ls -la .claude/commands/[job_name].*.md
```

#### 5. Document the Changes

Create `sync_verification.md` documenting:
- What was changed
- Which files were modified
- Verification results

## Output Format

### sync_verification.md

```markdown
# Sync Verification Report

## Job Updated
[job_name]

## Changes Made
- [List each file modified in src/deepwork/standard_jobs/]
- [Describe what was changed]

## Install Command
```
deepwork install --platform claude
```

## Verification Results

### Source → .deepwork/jobs/ sync
- [x] job.yml matches
- [x] steps/ files match
- [x] hooks/ files match (if applicable)

### Command Generation
- [x] .claude/commands/[job].[step].md regenerated

## Summary
All changes successfully propagated from source to installed locations.
```

## Quality Criteria

- Changes were made ONLY in `src/deepwork/standard_jobs/[job_name]/` (never in `.deepwork/jobs/`)
- `deepwork install --platform claude` was executed successfully
- Files in `.deepwork/jobs/[job_name]/` match the source files
- Command files in `.claude/commands/` were regenerated
- `sync_verification.md` documents all changes and confirms sync status
- When all criteria are met, include `<promise>✓ Quality Criteria Met</promise>` in your response

## Context

This job exists specifically for maintaining the DeepWork project itself. Standard jobs are bundled with DeepWork and distributed to users when they run `deepwork install`. By keeping the source of truth in `src/deepwork/standard_jobs/`, we ensure:

1. Changes are tracked in version control properly
2. The install command always has the latest version
3. Users get consistent, tested job definitions
4. We don't accidentally edit installed copies that get overwritten

This workflow is critical for anyone contributing to DeepWork's built-in job definitions.


## Inputs

### User Parameters

Please gather the following information from the user:
- **job_context**: Determine from conversation context which standard job(s) to update and what changes are needed


## Work Branch Management

All work for this job should be done on a dedicated work branch:

1. **Check current branch**:
   - If already on a work branch for this job (format: `deepwork/update-[instance]-[date]`), continue using it
   - If on main/master, create a new work branch

2. **Create work branch** (if needed):
   ```bash
   git checkout -b deepwork/update-[instance]-$(date +%Y%m%d)
   ```
   Replace `[instance]` with a descriptive identifier (e.g., `acme`, `q1-launch`, etc.)

## Output Requirements

Create the following output(s):
- `sync_verification.md`

Ensure all outputs are:
- Well-formatted and complete
- Ready for review or use by subsequent steps

## Completion

After completing this step:

1. **Verify outputs**: Confirm all required files have been created

2. **Inform the user**:
   - The job command is complete
   - Outputs created: sync_verification.md
   - This command can be run again anytime to make further changes

## Command Complete

This is a standalone command that can be run anytime. The outputs are ready for use.

Consider:
- Reviewing the outputs
- Running `deepwork sync` if job definitions were changed
- Re-running this command later if further changes are needed

---

## Context Files

- Job definition: `.deepwork/jobs/update/job.yml`
- Step instructions: `.deepwork/jobs/update/steps/job.md`
"""