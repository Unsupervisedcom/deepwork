# deepwork_jobs:define
#
# Creates a job.yml specification by gathering workflow requirements through structured questions. Use when starting a new multi-step workflow.
#
# Generated by DeepWork - do not edit manually

description = "Creates a job.yml specification by gathering workflow requirements through structured questions. Use when starting a new multi-step workflow."

prompt = """
# deepwork_jobs:define

**Step 1/4** in **deepwork_jobs** workflow

> Creates and manages multi-step AI workflows. Use when defining, implementing, or improving DeepWork jobs.


## Instructions

**Goal**: Creates a job.yml specification by gathering workflow requirements through structured questions. Use when starting a new multi-step workflow.

# Define Job Specification

## Objective

Create a `job.yml` specification file by thoroughly understanding the user's workflow requirements through structured questions.

## Task

Guide the user through defining a job specification by asking structured questions. **Do not attempt to create the specification without first fully understanding the user's needs.**

The output of this step is **only** the `job.yml` file. Step instruction files are created in the `implement` step.

### Step 1: Understand the Job Purpose

Ask structured questions to understand what the user wants to accomplish:

1. **What is the overall goal of this workflow?**
   - What complex task are they trying to accomplish?
   - What domain is this in? (e.g., research, marketing, development, reporting)

2. **What does success look like?**
   - What's the final deliverable or outcome?
   - Who is the audience for the output?

3. **What are the major phases?**
   - What are the distinct stages from start to finish?
   - Are there any dependencies between phases?

### Step 2: Detect Document-Oriented Workflows

Check for document-focused patterns in the user's description:
- Keywords: "report", "summary", "document", "monthly", "quarterly"
- Final deliverable is a specific document type
- Recurring documents with consistent structure

**If detected**, inform the user and ask if they want to:
- Create a doc spec for consistent document quality
- Use an existing doc spec from `.deepwork/doc_specs/`
- Skip doc spec and proceed with simple outputs

See the expert's documentation on doc specs for the full schema and examples.

### Step 3: Define Each Step

For each major phase, gather:

1. **Step Purpose**: What does this step accomplish?
2. **Inputs**: User parameters or files from previous steps
3. **Outputs**: Files or artifacts produced (see Work Product Guidelines below)
4. **Dependencies**: Which previous steps must complete first?
5. **Quality Criteria**: What makes a good vs. bad output?
6. **Agent Delegation**: Should this step run in a forked context?

#### Work Product Storage Guidelines

Job outputs belong in the main repository directory structure, not in dot-directories.

**Good patterns**:
```
competitive_research/competitors_list.md
operations/reports/2026-01/spending_analysis.md
```

**Avoid**:
```
.deepwork/outputs/report.md    # Hidden in dot-directory
output.md                       # Too generic
```

**Date in paths**: Include for periodic outputs (monthly reports), omit for living documents.

**Supporting materials**: Place in `_dataroom` folder as peer to final output:
```
operations/reports/2026-01/spending_analysis.md
operations/reports/2026-01/spending_analysis_dataroom/
    raw_data.csv
    notes.md
```

### Step 4: Validate the Workflow

After gathering all information:

1. **Review the flow** - Summarize and show how outputs feed into the next step
2. **Check for gaps** - Missing inputs, unused outputs, circular dependencies
3. **Confirm details** - Job name, summary (max 200 chars), description, version

### Step 5: Create the Job Specification

**First, create the directory structure**:
```bash
.deepwork/jobs/deepwork_jobs/make_new_job.sh [job_name]
```

**Then create `job.yml`** at `.deepwork/jobs/[job_name]/job.yml`

Refer to the expert for the complete job.yml schema. Key validation rules:
- Job name: lowercase, underscores only, no spaces
- Version: semantic versioning (start with 1.0.0)
- Summary: max 200 characters
- File inputs: `from_step` must be in dependencies
- At least one output per step

**Templates**:
- `.deepwork/jobs/deepwork_jobs/templates/job.yml.template` - Structure
- `.deepwork/jobs/deepwork_jobs/templates/job.yml.example` - Complete example

## Output

The validated `job.yml` file at `.deepwork/jobs/[job_name]/job.yml`.

After creating the file:
1. Inform the user that the specification is complete
2. Recommend they review the job.yml file
3. Tell them to run `/deepwork_jobs.review_job_spec` next


### Job Context

Core commands for managing DeepWork jobs. These commands help you define new multi-step
workflows and learn from running them.

The `new_job` workflow guides you through defining and implementing a new job by
asking structured questions about your workflow, understanding each step's inputs and outputs,
reviewing the specification, and generating all necessary files.

The `learn` skill reflects on conversations where DeepWork jobs were run, identifies
confusion or inefficiencies, and improves job instructions. It also captures bespoke
learnings specific to the current run into AGENTS.md files in the working folder.


## Required Inputs

**User Parameters** - Gather from user before starting:
- **job_purpose**: What complex task or workflow are you trying to accomplish?


## Work Branch

Use branch format: `deepwork/deepwork_jobs-[instance]-YYYYMMDD`

- If on a matching work branch: continue using it
- If on main/master: create new branch with `git checkout -b deepwork/deepwork_jobs-[instance]-$(date +%Y%m%d)`

## Outputs

**Required outputs**:
- `job.yml`
  **Doc Spec**: DeepWork Job Specification
  > YAML specification file that defines a multi-step workflow job for AI agents
  **Definition**: `.deepwork/doc_specs/job_spec.md`
  **Target Audience**: AI agents executing jobs and developers defining workflows
  **Quality Criteria**:
  1. **Valid Identifier**: Job name must be lowercase with underscores, no spaces or special characters (e.g., `competitive_research`, `monthly_report`)
  2. **Semantic Version**: Version must follow semantic versioning format X.Y.Z (e.g., `1.0.0`, `2.1.3`)
  3. **Concise Summary**: Summary must be under 200 characters and clearly describe what the job accomplishes
  4. **Rich Description**: Description must be multi-line and explain: the problem solved, the process, expected outcomes, and target users
  5. **Changelog Present**: Must include a changelog array with at least the initial version entry. Changelog should only include one entry per branch at most
  6. **Complete Steps**: Each step must have: id (lowercase_underscores), name, description, instructions_file, outputs (at least one), and dependencies array
  7. **Valid Dependencies**: Dependencies must reference existing step IDs with no circular references
  8. **Input Consistency**: File inputs with `from_step` must reference a step that is in the dependencies array
  9. **Output Paths**: Outputs must be valid filenames or paths within the main repo directory structure, never in dot-directories like `.deepwork/`. Use specific, descriptive paths that lend themselves to glob patterns (e.g., `competitive_research/acme_corp/swot.md` or `operations/reports/2026-01/spending_analysis.md`). Parameterized paths like `[competitor_name]/` are encouraged for per-entity outputs. Avoid generic names (`output.md`, `analysis.md`) and transient-sounding paths (`temp/`, `draft.md`). Supporting materials for a final output should go in a peer `_dataroom` folder (e.g., `spending_analysis_dataroom/`).
  10. **Concise Instructions**: The content of the file, particularly the description, must not have excessively redundant information. It should be concise and to the point given that extra tokens will confuse the AI.

## On Completion

1. Verify outputs are created
2. Inform user: "Step 1/4 complete, outputs: job.yml"
3. **Tell user next command**: `/deepwork_jobs:review_job_spec`

---

**Reference files**: `.deepwork/jobs/deepwork_jobs/job.yml`, `.deepwork/jobs/deepwork_jobs/steps/define.md`
"""