# Prepare Release Files

## Objective

Update the CHANGELOG.md with a new version entry, bump the version in pyproject.toml, and sync uv.lock.

## Task

Read the changes summary from the previous step and use it to update the release files with the confirmed version number.

### Process

1. **Read the changes summary**
   Load `release/changes_summary.md` to get:
   - The confirmed new version number
   - The categorized changes

2. **Update CHANGELOG.md**
   Add a new version entry at the top of the changelog (after the header), following the Keep a Changelog format:

   ```markdown
   ## [X.Y.Z] - YYYY-MM-DD

   ### Added
   - [features from changes summary]

   ### Changed
   - [modifications from changes summary]

   ### Fixed
   - [bug fixes from changes summary]
   ```

   Also add the version link at the bottom:
   ```markdown
   [X.Y.Z]: https://github.com/anthropics/deepwork/releases/tag/X.Y.Z
   ```

3. **Update pyproject.toml**
   Change the `version` field to the new version:
   ```toml
   version = "X.Y.Z"
   ```

4. **Sync uv.lock**
   Run:
   ```bash
   uv lock
   ```
   This updates the lock file with the new version.

## Output Format

The outputs are modifications to existing files:

### CHANGELOG.md

Add a new version section following Keep a Changelog format. Only include categories that have entries (don't include empty "### Removed" sections).

**Example entry**:
```markdown
## [0.6.0] - 2026-01-21

### Added
- New `make_release` job for automating release preparation

### Fixed
- Fixed edge case in version parsing
```

### pyproject.toml

Update the version field:
```toml
version = "0.6.0"
```

### uv.lock

This is auto-generated by `uv lock`. No manual edits needed.

## Quality Criteria

- CHANGELOG.md has a new version entry with today's date
- Version entry follows Keep a Changelog format
- Only non-empty categories are included in the changelog entry
- pyproject.toml version is updated to match
- `uv lock` ran successfully
- Version link is added at the bottom of CHANGELOG.md
- Changes in CHANGELOG match what was in the changes summary
- When all criteria are met, include `<promise>âœ“ Quality Criteria Met</promise>` in your response

## Context

This step transforms the raw change data into properly formatted release files. The CHANGELOG.md follows the Keep a Changelog format used by this project, which organizes changes into categories like Added, Changed, Fixed, etc. The next step will create a PR with these changes.
