# yaml-language-server: $schema=.deepwork/schemas/job.schema.json
name: update
version: "1.4.0"
summary: "Updates DeepWork standard jobs in src/ and syncs to installed locations. Use when modifying deepwork_jobs."
description: |
  A workflow for maintaining standard jobs bundled with DeepWork. Standard jobs
  (like `deepwork_jobs`) are source-controlled in
  `src/deepwork/standard_jobs/` and must be edited thereâ€”never in `.deepwork/jobs/`
  or `.claude/commands/` directly.

  This job guides you through:
  1. Identifying which standard job(s) to update from conversation context
  2. Making changes in the correct source location (`src/deepwork/standard_jobs/[job_name]/`)
  3. Running `deepwork install` to propagate changes to `.deepwork/` and command directories
  4. Verifying the sync completed successfully

  Use this job whenever you need to modify job.yml files, step instructions, or hooks
  for any standard job in the DeepWork repository.

workflows:
  - name: update
    summary: "Update standard job source files and sync to installed locations"
    steps:
      - job

changelog:
  - version: "1.4.0"
    changes: "Added workflow for MCP compatibility; migrated stop_hooks to quality_criteria"
  - version: "1.0.0"
    changes: "Initial job creation"
  - version: "1.1.0"
    changes: "Removed sync_verification.md output requirement"
  - version: "1.2.0"
    changes: "Added nominal output for doc spec compliance (files_synced)"
  - version: "1.3.0"
    changes: "Improved skill descriptions with third-person voice and 'Use when...' triggers for better discoverability"

steps:
  - id: job
    name: "Update Standard Job"
    description: "Edits standard job source files in src/ and runs deepwork install to sync changes. Use when updating job.yml or step instructions."
    instructions_file: steps/job.md
    inputs:
      - name: job_context
        description: "Determine from conversation context which standard job(s) to update and what changes are needed"
    outputs:
      - files_synced  # implicit state: source files synced to installed locations
    dependencies: []
    quality_criteria:
      - "**Source Location**: Were changes made in `src/deepwork/standard_jobs/[job_name]/` (NOT in `.deepwork/jobs/`)?"
      - "**Install Complete**: Was `deepwork install --platform claude` run successfully?"
      - "**Files Synced**: Do files in `.deepwork/jobs/` match the source files?"
      - "**Commands Regenerated**: Were command files in `.claude/commands/` regenerated?"
